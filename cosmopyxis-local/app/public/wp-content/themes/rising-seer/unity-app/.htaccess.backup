# Rising Seer Unity WebGL Configuration
# DUAL DEPLOYMENT: Serves appropriate version based on browser

# CRITICAL: Disable PHP completely for Unity files
# Options -ExecCGI
# php_flag engine off
# AddHandler default-handler .js .wasm .data .gz .json .html

# CRITICAL: Force correct MIME types for JavaScript files
<IfModule mod_mime.c>
    # Remove any existing MIME type associations that might interfere
    RemoveType .js
    RemoveType .wasm
    RemoveType .data
    
    # Set correct MIME types
    AddType application/javascript .js
    AddType application/wasm .wasm
    AddType application/octet-stream .data
    AddType application/octet-stream .symbols.json
</IfModule>

# MIME types for pre-compressed Unity files
<IfModule mod_mime.c>
    AddType application/wasm .wasm.gz
    AddType application/javascript .js.gz
    AddType application/octet-stream .data.gz
</IfModule>

# SPECIFIC FIX: Force loader.js to be served as JavaScript
<Files "unity-app.loader.js">
    ForceType application/javascript
</Files>

<Files "*.js">
    ForceType application/javascript
</Files>

# Remove Content-Encoding for .gz files (Safari compatibility)
<IfModule mod_headers.c>
    <FilesMatch "\.(js|wasm|data)\.gz$">
        Header unset Content-Encoding
    </FilesMatch>
</IfModule>

# Disable compression for already compressed files
<IfModule mod_deflate.c>
    SetEnvIfNoCase Request_URI \.gz$ no-gzip dont-vary
</IfModule>

# Cache control for Unity assets
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType application/wasm "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/octet-stream "access plus 1 month"
</IfModule>

# Security headers
Header always set X-Frame-Options "SAMEORIGIN"
Header always set X-Content-Type-Options "nosniff"
